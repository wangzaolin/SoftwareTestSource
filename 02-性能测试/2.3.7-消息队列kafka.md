# 消息队列kafka

参考文档：

https://www.cnblogs.com/qingyunzong/p/9004509.html#_label1

# 1、功能

kafka是由Linkedin公司开发的，一个分布式、分区的、多副本的、基于zookeeper协调的分布式日志系统，常用于web/nginx日志、访问日志和消息服务；

主要应用场景：日志收集系统和消息系统；

# 2、架构图

![image-20210118143201092](https://wangzaolin.github.io/SoftwareTest/mybook/img/image-20210118143201092.png)

名词解释：

- broker:Kafka 集群包含一个或多个服务器，服务器节点称为broker;
- topics：每条发布到Kafka集群的消息都有一个类别，这个类别被称为Topic。
- partition：topic中的数据分割为一个或多个partition。每个topic至少有一个partition。每个partition中的数据使用多个segment文件存储。
- producer:生产者即数据的发布者，该角色将消息发布到Kafka的topic中。broker接收到生产者发送的消息后，broker将该消息**追加**到当前用于追加数据的segment文件中。
- consumer：消费者可以从broker中读取数据。消费者可以消费多个topic中的数据。

# 3、kafka的优点

- 解耦

  在项目启动之初来预测将来项目会碰到什么需求，是极其困难的。消息系统在处理过程中间插入了一个隐含的、基于数据的接口层，两边的处理过程都要实现这一接口。这允许你独立的扩展或修改两边的处理过程，只要确保它们遵守同样的接口约束。

- 冗余

  消息队列把数据进行持久化直到它们已经被完全处理，通过这一方式规避了数据丢失风险。

- 扩展性

  消息队列解耦了你的处理过程，所以增大消息入队和处理的频率是很容易的，只要另外增加处理过程即可。不需要改变代码、不需要调节参数。扩展就像调大电力按钮一样简单。

- 灵活性

  使用消息队列能够使关键组件顶住突发的访问压力，而不会因为突发的超负荷的请求而完全崩溃。

- 可恢复性

  系统的一部分组件失效时，不会影响到整个系统。消息队列降低了进程间的耦合度，所以即使一个处理消息的进程挂掉，加入队列中的消息仍然可以在系统恢复后被处理。

- 顺序保证

  大部分消息队列本来就是排序的，并且能保证数据会按照特定的顺序来处理。Kafka保证一个Partition内的消息的有序性。

- 缓冲

  消息队列通过一个缓冲层来帮助任务最高效率的执行———写入队列的处理会尽可能的快速。该缓冲有助于控制和优化数据流经过系统的速度。

- 异步通信

  消息队列提供了异步处理机制，允许用户把一个消息放入队列，但并不立即处理它。想向队列中放入多少消息就放多少，然后在需要的时候再去处理它们。